# 견적서 웹 뷰어 및 PDF 생성 시스템 - PRD (Product Requirements Document)

## 1. Executive Summary

### 제품 목적 및 비전
견적서 웹 뷰어 및 PDF 생성 시스템은 노션에서 작성한 견적서를 클라이언트가 웹 브라우저에서 직접 확인하고 PDF로 다운로드할 수 있도록 하는 플랫폼입니다. 이를 통해 견적서 전달 과정을 간소화하고 클라이언트 경험을 개선합니다.

### 해결하려는 문제
- 노션으로 작성한 견적서를 클라이언트에게 공유할 때 노션 접근 권한 관리의 번거로움
- 견적서를 PDF로 수동 변환하고 이메일로 첨부하는 비효율적인 프로세스
- 클라이언트가 견적서를 확인했는지 추적의 어려움
- 브랜딩이 적용된 전문적인 견적서 제공의 한계

### 핵심 가치 제안
- **발송자**: 노션에서 견적서 작성 후 클릭 한 번으로 공유 가능한 링크 생성
- **클라이언트**: 별도 계정 없이 웹에서 즉시 확인 가능하며, 원할 때 PDF 다운로드 가능
- **자동화**: 견적서 업데이트 시 자동으로 웹 페이지에 반영

---

## 2. 목표 및 성공 지표

### 비즈니스 목표
- 견적서 발송 시간 70% 단축
- 클라이언트 응답률 30% 향상
- 견적서 관리 프로세스 자동화

### 사용자 목표
- **발송자**: 5분 이내에 견적서 생성 및 공유 완료
- **클라이언트**: 모바일/데스크톱에서 즉시 견적서 확인 가능

### 측정 가능한 KPI
- 견적서 링크 생성 시간 (목표: 평균 2분 이하)
- 견적서 확인율 (목표: 90% 이상)
- PDF 다운로드율 (목표: 60% 이상)
- 클라이언트의 평균 응답 시간 (목표: 24시간 이내)
- 시스템 페이지 로딩 시간 (목표: 3초 이내)

---

## 3. 사용자 페르소나 및 시나리오

### 페르소나 1: 견적서 발송자 (관리자)
- **역할**: 프리랜서, 에이전시 운영자, 중소기업 영업 담당자
- **니즈**: 빠르고 전문적인 견적서 발송, 진행 상황 추적
- **기술 수준**: 중급 (노션 사용 가능)

**사용 시나리오**:
1. 노션 데이터베이스에 새 견적서 항목 생성
2. 견적 항목(서비스명, 수량, 단가, 총액) 입력
3. 시스템에서 "링크 생성" 버튼 클릭
4. 생성된 고유 URL을 클라이언트에게 이메일/메신저로 전송
5. 클라이언트 확인 여부를 대시보드에서 확인

### 페르소나 2: 견적서 수신자 (클라이언트)
- **역할**: 서비스 구매 고려 중인 고객
- **니즈**: 명확하고 읽기 쉬운 견적서, 언제든 재확인 및 저장 가능
- **기술 수준**: 초급~중급

**사용 시나리오**:
1. 이메일/메신저로 받은 견적서 링크 클릭
2. 웹 브라우저에서 견적서 내용 확인 (항목, 금액, 조건 등)
3. 필요 시 "PDF 다운로드" 버튼 클릭
4. 다운로드된 PDF를 로컬에 저장 또는 인쇄

---

## 4. 기능 명세 (MVP 범위)

### 4.1 노션 연동
**우선순위**: Must-have

**사용자 스토리**:
> "관리자로서, 노션 데이터베이스에 견적서를 작성하면 시스템이 자동으로 데이터를 가져와 웹 페이지로 생성할 수 있기를 원한다."

**수용 기준**:
- [ ] Notion API를 통해 특정 데이터베이스의 견적서 페이지를 읽어올 수 있음
- [ ] 견적서 필수 필드: 견적 번호, 발행일, 클라이언트명, 항목 리스트(항목명, 수량, 단가, 금액), 총액, 유효기간
- [ ] 노션 페이지 업데이트 시 웹 페이지도 실시간 또는 캐시 갱신을 통해 반영됨
- [ ] API 연동 오류 시 적절한 에러 메시지 표시

### 4.2 견적서 웹 뷰 페이지
**우선순위**: Must-have

**사용자 스토리**:
> "클라이언트로서, 링크를 클릭하면 로그인 없이 바로 견적서를 깔끔한 레이아웃으로 확인할 수 있기를 원한다."

**수용 기준**:
- [ ] 반응형 디자인 (모바일, 태블릿, 데스크톱 대응)
- [ ] 견적서 항목이 표 형태로 명확하게 표시됨
- [ ] 회사 로고, 연락처 정보 표시
- [ ] 총액이 강조되어 표시됨
- [ ] 페이지 로딩 시간 3초 이내

### 4.3 PDF 생성 및 다운로드
**우선순위**: Must-have

**사용자 스토리**:
> "클라이언트로서, 웹에서 확인한 견적서를 PDF 파일로 다운로드하여 보관하거나 인쇄할 수 있기를 원한다."

**수용 기준**:
- [ ] "PDF 다운로드" 버튼 클릭 시 즉시 다운로드 시작
- [ ] PDF는 웹 페이지와 동일한 레이아웃과 내용 유지
- [ ] PDF 파일명: `견적서_[클라이언트명]_[견적번호].pdf`
- [ ] A4 용지 크기, 인쇄 최적화
- [ ] PDF 생성 시간 5초 이내

### 4.4 고유 링크 생성 및 관리
**우선순위**: Must-have

**사용자 스토리**:
> "관리자로서, 각 견적서마다 고유하고 추측 불가능한 URL을 생성하여 권한이 있는 클라이언트만 접근할 수 있도록 하고 싶다."

**수용 기준**:
- [ ] 견적서별 고유 UUID 또는 난수 기반 URL 생성 (예: `/quote/a3f2d9e1-4b2c-4a3d...`)
- [ ] URL 복사 기능 제공
- [ ] (선택) 링크 만료 기간 설정 가능 (기본 30일)
- [ ] 유효하지 않은 URL 접근 시 404 페이지 표시
- [ ] 삭제된 견적서 링크 접근 시 안내 메시지 표시

### 4.5 견적서 상태 추적 (선택)
**우선순위**: Should-have

**사용자 스토리**:
> "관리자로서, 클라이언트가 견적서를 확인했는지, PDF를 다운로드했는지 알고 싶다."

**수용 기준**:
- [ ] 최초 조회 시간 기록
- [ ] PDF 다운로드 여부 및 시간 기록
- [ ] 관리자 대시보드에서 상태 확인 가능
- [ ] 상태: 미확인 / 확인됨 / PDF 다운로드됨

---

## 5. 기술 요구사항

### 권장 기술 스택
**Frontend**:
- Next.js 16 (App Router) - 현재 프로젝트와 동일
- React 19
- TypeScript (strict mode)
- Tailwind CSS 4
- shadcn/UI 컴포넌트

**Backend**:
- Next.js API Routes 또는 Server Actions
- Notion API SDK (@notionhq/client)
- PDF 생성: Puppeteer, Playwright, 또는 react-pdf/renderer

**Database** (선택):
- PostgreSQL (견적서 메타데이터, 조회 기록 저장)
- 또는 Notion을 단일 진실 공급원(Single Source of Truth)으로 활용

**Hosting**:
- Vercel (Next.js 최적화)

### 노션 API 활용 방안
1. **Integration 생성**: Notion workspace에 Internal Integration 생성
2. **데이터베이스 구조**:
   ```
   견적서 데이터베이스 (Database)
   ├─ 견적 번호 (Title)
   ├─ 클라이언트명 (Text)
   ├─ 발행일 (Date)
   ├─ 유효기간 (Date)
   ├─ 상태 (Select: 작성중, 발송됨, 확인됨)
   ├─ 총액 (Number)
   └─ 항목 (Relation to 견적 항목 DB)

   견적 항목 데이터베이스 (Database)
   ├─ 항목명 (Title)
   ├─ 수량 (Number)
   ├─ 단가 (Number)
   ├─ 금액 (Formula: 수량 × 단가)
   └─ 견적서 (Relation)
   ```

3. **API 엔드포인트**:
   - `GET /api/quote/:id` - 견적서 데이터 조회
   - `POST /api/quote/generate-link` - 고유 링크 생성
   - `GET /api/quote/:id/pdf` - PDF 생성 및 다운로드

### PDF 생성 라이브러리 비교

| 라이브러리 | 장점 | 단점 | 추천도 |
|-----------|------|------|--------|
| **Puppeteer** | HTML→PDF 완벽 재현, 웹 페이지 그대로 변환 | 서버 리소스 많이 사용, cold start 느림 | ⭐⭐⭐⭐⭐ |
| **Playwright** | Puppeteer와 유사, 더 나은 브라우저 지원 | 번들 크기 큼 | ⭐⭐⭐⭐ |
| **react-pdf** | React 컴포넌트로 PDF 정의, 가벼움 | HTML/CSS 완전 재현 불가 | ⭐⭐⭐ |
| **jsPDF** | 클라이언트 사이드 생성 가능 | 레이아웃 제어 복잡 | ⭐⭐ |

**MVP 추천**: **Puppeteer** (웹 페이지와 PDF 일관성 보장)

### 보안 요구사항
- [ ] HTTPS 필수
- [ ] 견적서 URL에 UUID 사용 (추측 불가능)
- [ ] Rate limiting (DDoS 방지)
- [ ] CORS 설정
- [ ] 환경 변수로 Notion API 키 관리
- [ ] (선택) 링크 만료 기능
- [ ] (선택) 비밀번호 보호 옵션

### 성능 요구사항
- [ ] 페이지 로딩 시간: 3초 이내 (LCP)
- [ ] PDF 생성 시간: 5초 이내
- [ ] Notion API 응답 캐싱 (TTL: 5분)
- [ ] 이미지 최적화 (Next.js Image 컴포넌트)
- [ ] 동시 접속 100명 이상 처리 가능

---

## 6. 사용자 흐름 (User Flow)

### 관리자 플로우
```
1. 노션에서 견적서 데이터베이스에 새 페이지 생성
   ↓
2. 견적 정보 입력 (클라이언트명, 항목, 금액 등)
   ↓
3. 시스템 대시보드에서 해당 견적서 선택
   ↓
4. "링크 생성" 버튼 클릭
   ↓
5. 생성된 URL 복사
   ↓
6. 클라이언트에게 이메일/메신저로 전송
   ↓
7. (선택) 대시보드에서 조회 상태 확인
```

### 클라이언트 플로우
```
1. 이메일/메신저에서 견적서 링크 수신
   ↓
2. 링크 클릭 (모바일/데스크톱 브라우저)
   ↓
3. 견적서 웹 페이지 로딩
   ↓
4. 견적 내용 확인 (항목, 금액, 조건 등)
   ↓
5. (선택) "PDF 다운로드" 버튼 클릭
   ↓
6. PDF 파일 다운로드 완료
```

---

## 7. UI/UX 요구사항

### 견적서 뷰 페이지 레이아웃

```
┌─────────────────────────────────────┐
│  [회사 로고]              견적서     │
│                                     │
│  견적 번호: Q2024-001               │
│  발행일: 2024-01-15                 │
│  유효기간: 2024-02-15               │
├─────────────────────────────────────┤
│  수신: [클라이언트명]               │
├─────────────────────────────────────┤
│  항목        수량   단가      금액  │
│  ────────────────────────────────  │
│  웹사이트개발  1   5,000,000  5,000,000 │
│  디자인작업    1   2,000,000  2,000,000 │
│  유지보수(3개월) 1 1,500,000  1,500,000 │
├─────────────────────────────────────┤
│                    총액: 8,500,000원 │
├─────────────────────────────────────┤
│  [ PDF 다운로드 ]                   │
└─────────────────────────────────────┘
```

### 디자인 가이드라인
- **색상**:
  - Primary: 브랜드 컬러 (커스터마이징 가능)
  - Background: White (#FFFFFF)
  - Text: Dark Gray (#1F2937)
  - Accent: Blue (#3B82F6)
- **타이포그래피**:
  - 제목: 24px, Bold
  - 본문: 16px, Regular
  - 표 헤더: 14px, Semi-bold
- **간격**: 여백 충분히 확보 (Tailwind spacing 기준)
- **버튼**: Primary 버튼 스타일, 명확한 CTA

### 모바일 반응형 대응
- [ ] 320px 이상 모든 화면 크기 지원
- [ ] 표는 모바일에서 스크롤 또는 카드 형식으로 전환
- [ ] 터치 친화적 버튼 크기 (최소 44x44px)
- [ ] 폰트 크기 자동 조정

### 브랜딩 요소
- [ ] 회사 로고 업로드 및 표시
- [ ] 커스텀 색상 설정 (Primary, Secondary)
- [ ] 푸터에 회사 연락처 정보 표시

---

## 8. MVP 범위 밖 (향후 고려사항)

### Phase 2 기능
- 전자 서명 기능 (클라이언트가 견적 승인)
- 견적 승인/거절 버튼
- 승인 시 자동 계약서 생성
- 이메일 알림 (견적서 확인 시)

### Phase 3 기능
- 견적서 내 채팅/코멘트 기능
- 견적 항목별 질문/답변
- 다국어 지원 (영어, 일본어 등)
- 견적서 템플릿 다중 선택
- 결제 링크 통합 (Stripe, 토스페이먼츠)

### 분석 및 리포팅
- Google Analytics 연동
- 견적서 전환율 대시보드
- 클라이언트 행동 분석 (체류 시간, 스크롤 깊이)

---

## 9. 리스크 및 제약사항

### 노션 API 제한사항
- **Rate Limit**: 초당 3 requests (평균) - 캐싱으로 완화
- **읽기 전용**: Notion API를 통한 상태 업데이트 제한 - 별도 DB 필요
- **복잡한 블록 구조**: Rich text parsing 필요 - 구조 단순화 권장

### 보안 및 개인정보 보호 이슈
- 견적서에 민감한 가격 정보 포함 - UUID 기반 보안 URL 필수
- GDPR/개인정보보호법 준수 - 클라이언트 정보 최소화
- URL 노출 시 누구나 접근 가능 - 링크 만료 또는 비밀번호 기능 고려

### 기술적 제약사항
- **PDF 생성 성능**: Puppeteer는 서버리스 환경(Vercel)에서 cold start 느림 → Edge Functions 또는 별도 PDF 서비스 고려
- **동시 접속 처리**: Vercel 무료 플랜 제한 - 프로 플랜 필요 시 비용 고려
- **노션 API 다운타임**: Fallback 메커니즘 부재 - 에러 페이지 안내

### 비즈니스 리스크
- 노션 의존성: Notion API 정책 변경 시 영향 - 다른 데이터 소스 지원 고려
- 경쟁 서비스: 유사 SaaS 존재 - 차별화 포인트 명확화 필요

---

## 10. 출시 일정 및 마일스톤

### Phase 1: 기반 구축 (Week 1-2)
- [ ] 프로젝트 초기 설정 (Next.js, TypeScript, Tailwind)
- [ ] Notion API 연동 및 데이터 fetch 구현
- [ ] 기본 견적서 웹 뷰 페이지 UI 개발

**마일스톤**: 노션 데이터를 웹 페이지로 표시 가능

### Phase 2: 핵심 기능 개발 (Week 3-4)
- [ ] PDF 생성 기능 구현 (Puppeteer 통합)
- [ ] 고유 URL 생성 시스템 구축
- [ ] 반응형 디자인 완성

**마일스톤**: 클라이언트가 링크로 접속하여 PDF 다운로드 가능

### Phase 3: 관리 기능 (Week 5)
- [ ] 관리자 대시보드 개발
- [ ] 링크 생성 UI
- [ ] (선택) 조회 상태 추적 기능

**마일스톤**: 관리자가 스스로 견적서 링크 생성 및 관리 가능

### Phase 4: 테스트 및 최적화 (Week 6)
- [ ] 성능 테스트 (페이지 로딩, PDF 생성 속도)
- [ ] 브라우저 호환성 테스트 (Chrome, Safari, Firefox)
- [ ] 모바일 테스트 (iOS, Android)
- [ ] 보안 점검 (URL 추측 가능성, XSS 등)

**마일스톤**: 프로덕션 배포 준비 완료

### Phase 5: 베타 런칭 (Week 7)
- [ ] 내부 테스트용 배포 (Vercel Preview)
- [ ] 3-5명의 베타 사용자 피드백 수집
- [ ] 버그 수정 및 UX 개선

**마일스톤**: 베타 사용자 만족도 80% 이상

### Phase 6: 정식 출시 (Week 8)
- [ ] 프로덕션 배포 (Vercel Production)
- [ ] 모니터링 설정 (Sentry, Vercel Analytics)
- [ ] 사용자 가이드 문서 작성
- [ ] 공식 런칭 공지

**마일스톤**: MVP 정식 출시 완료

---

## 부록: 기술 스펙 예시

### 환경 변수
```env
NOTION_API_KEY=secret_xxxxxxxxxxxxx
NOTION_DATABASE_ID=xxxxxxxxxxxxx
NEXT_PUBLIC_APP_URL=https://quote.example.com
PDF_GENERATION_TIMEOUT=30000
```

### API 엔드포인트 명세

#### 1. 견적서 조회
```
GET /api/quote/[id]

Response:
{
  "id": "uuid",
  "quoteNumber": "Q2024-001",
  "clientName": "ABC 주식회사",
  "issueDate": "2024-01-15",
  "expiryDate": "2024-02-15",
  "items": [
    {
      "name": "웹사이트 개발",
      "quantity": 1,
      "unitPrice": 5000000,
      "amount": 5000000
    }
  ],
  "totalAmount": 8500000,
  "status": "sent"
}
```

#### 2. PDF 다운로드
```
GET /api/quote/[id]/pdf

Response: application/pdf (binary)
```

---

**문서 버전**: 1.0
**작성일**: 2024-01-15
**검토 필요**: 개발팀, 디자인팀
**승인 필요**: 프로덕트 오너
